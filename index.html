<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Draft APBDus 2026 - Kuamang Jaya</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    
    <style>
        body { background-color: #f4f6f9; font-family: 'Segoe UI', sans-serif; }
        .card-header-custom { background-color: #198754; color: white; font-weight: bold; }
        .money { font-family: 'Courier New', monospace; font-weight: bold; }
        .accordion-button:not(.collapsed) { color: #0f5132; background-color: #d1e7dd; font-weight: bold; }
        .sub-bidang-title { font-size: 0.9rem; text-transform: uppercase; color: #198754; font-weight: 800; border-bottom: 2px solid #a3cfbb; padding: 5px 0 5px 10px; margin: 20px 0 10px 0; background-color: #e9f7ef; }
        .rincian-item { border-bottom: 1px dashed #e0e0e0; padding: 8px 0; display: flex; justify-content: space-between; align-items: center; font-size: 0.9rem; }
        .rincian-item:hover { background-color: #f8f9fa; }
        .item-detail { color: #555; }
        .badge-sumber { font-size: 0.65rem; width: 45px; display: inline-block; text-align: center; margin-right: 8px; }
        .bg-gradient-success { background: linear-gradient(45deg, #198754, #28a745); }
        .bg-gradient-primary { background: linear-gradient(45deg, #0d6efd, #0dcaf0); }
        .bg-gradient-warning { background: linear-gradient(45deg, #ffc107, #ffdb58); }
    </style>
</head>
<body>

    <div class="bg-white shadow-sm py-4 mb-4 border-bottom border-success border-4">
        <div class="container text-center">
            <h2 class="fw-bold text-success mb-0"><i class="fas fa-edit me-2"></i>DRAFT APBDus 2026</h2>
            <p class="text-muted">Pemerintah Dusun Kuamang Jaya (Tahap Input)</p>
        </div>
    </div>

    <div class="container mb-5">
        <div class="row g-4 mb-4">
            <div class="col-md-4"><div class="card h-100 border-0 shadow-sm text-white bg-gradient-primary"><div class="card-body text-center"><h6 class="opacity-75">TOTAL PENDAPATAN</h6><h3 class="fw-bold" id="totalPendapatan">Rp 0</h3></div></div></div>
            <div class="col-md-4"><div class="card h-100 border-0 shadow-sm text-white bg-gradient-success"><div class="card-body text-center"><h6 class="opacity-75">TOTAL BELANJA</h6><h3 class="fw-bold" id="totalBelanja">Rp 0</h3></div></div></div>
            <div class="col-md-4"><div class="card h-100 border-0 shadow-sm text-dark bg-gradient-warning"><div class="card-body text-center"><h6 class="opacity-75">SURPLUS / (DEFISIT)</h6><h3 class="fw-bold" id="totalSelisih">Rp 0</h3></div></div></div>
        </div>

        <div class="row">
            <div class="col-lg-4 mb-4">
                <div class="card shadow-sm border-0 h-100">
                    <div class="card-header card-header-custom">INPUT PENDAPATAN</div>
                    <div class="card-body p-0">
                        <table class="table table-hover mb-0">
                            <tbody id="tabelPendapatan">
                                </tbody>
                        </table>
                    </div>
                </div>
            </div>

            <div class="col-lg-8 mb-4">
                <div class="card shadow-sm border-0">
                    <div class="card-header bg-danger text-white fw-bold"><i class="fas fa-list-alt me-2"></i> INPUT RINCIAN BELANJA</div>
                    <div class="card-body">
                        <div class="accordion" id="accordionBelanja">
                            </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="text-center mt-5 text-muted small pb-4"><p>&copy; 2026 Pemerintah Dusun Kuamang Jaya.</p></div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <script>
        
        // 1. INPUT DATA PENDAPATAN (Ganti Angkanya Saja)
        // Gunakan angka biasa tanpa titik/koma. Contoh: 100000000
        const dataPendapatan = [
            { uraian: "Dana Desa (DDS)",     kode: "DDS", nominal: 900000000 },
            { uraian: "Alokasi Dana Dusun",  kode: "ADD", nominal: 500000000 },
            { uraian: "Bagi Hasil Pajak",    kode: "PBH", nominal: 50000000 },
            { uraian: "Pendapatan Asli",     kode: "PAD", nominal: 350000000 },
            { uraian: "Bantuan Provinsi",    kode: "PBP", nominal: 50000000 },
        ];

        // 2. INPUT DATA BELANJA (Kelompokkan per Sub Bidang)
        const dataBelanja = [
            // --- BIDANG 1 ---
            {
                bidang: "1. Bidang Penyelenggaraan Pemerintahan",
                subBidang: [
                    {
                        namaSub: "1.1. Siltap & Tunjangan",
                        kegiatan: [
                            { nama: "Siltap Rio (Kades)",  sumber: "ADD", nilai: 60000000 },
                            { nama: "Siltap Sekdus",       sumber: "ADD", nilai: 42000000 },
                            { nama: "Siltap Perangkat Lain", sumber: "ADD", nilai: 200000000 },
                            { nama: "Tunjangan BPD",       sumber: "ADD", nilai: 40000000 },
                        ]
                    },
                    {
                        namaSub: "1.2. Operasional Pemerintahan",
                        kegiatan: [
                            { nama: "ATK & Listrik",       sumber: "PBH", nilai: 20000000 },
                            { nama: "Internet Kantor",     sumber: "PBH", nilai: 10000000 },
                            { nama: "Insentif RT/RW",      sumber: "ADD", nilai: 80000000 },
                        ]
                    }
                ]
            },
            // --- BIDANG 2 ---
            {
                bidang: "2. Bidang Pembangunan",
                subBidang: [
                    {
                        namaSub: "2.3. Pekerjaan Umum",
                        kegiatan: [
                            { nama: "Jalan Usaha Tani RT 1", sumber: "DDS", nilai: 100000000 },
                            { nama: "Jembatan Gantung",      sumber: "DDS", nilai: 50000000 },
                        ]
                    },
                    {
                        namaSub: "2.4. Kawasan Pemukiman",
                        kegiatan: [
                            { nama: "Lampu Jalan (PJU)",     sumber: "PBH", nilai: 30000000 },
                        ]
                    }
                ]
            },
            // --- BIDANG 3 ---
            {
                bidang: "3. Bidang Pembinaan",
                subBidang: [
                    {
                        namaSub: "3.2. Kebudayaan",
                        kegiatan: [
                            { nama: "HUT RI & PHBI",         sumber: "ADD", nilai: 25000000 },
                        ]
                    }
                ]
            },
            // --- BIDANG 4 ---
            {
                bidang: "4. Bidang Pemberdayaan",
                subBidang: [
                    {
                        namaSub: "4.1. Ketahanan Pangan",
                        kegiatan: [
                            { nama: "Bibit Sawit/Ternak",    sumber: "DDS", nilai: 150000000 },
                        ]
                    }
                ]
            },
            // --- BIDANG 5 ---
            {
                bidang: "5. Penanggulangan Bencana",
                subBidang: [
                    {
                        namaSub: "5.1. Keadaan Mendesak",
                        kegiatan: [
                            { nama: "BLT Dana Desa (Max 25%)", sumber: "DDS", nilai: 100000000 },
                        ]
                    }
                ]
            }
        ];

        /* =========================================================== 
           JANGAN UBAH KODE DI BAWAH INI (Sistem Render Otomatis) 
           =========================================================== */
        
        // Helper Format Rupiah
        const fmt = (n) => new Intl.NumberFormat('id-ID', { style: 'currency', currency: 'IDR', maximumFractionDigits: 0 }).format(n);

        // Render Pendapatan
        let htmlPendapatan = "";
        let totPendapatan = 0;
        dataPendapatan.forEach(d => {
            let warnaBadge = d.kode === 'DDS' ? 'bg-primary' : d.kode === 'ADD' ? 'bg-success' : d.kode === 'PAD' ? 'bg-warning text-dark' : 'bg-secondary';
            htmlPendapatan += `<tr><td class="ps-3 small">${d.uraian} <span class="badge ${warnaBadge} ms-1" style="font-size:0.6rem">${d.kode}</span></td><td class="money pe-3 text-end small">${fmt(d.nominal)}</td></tr>`;
            totPendapatan += d.nominal;
        });
        htmlPendapatan += `<tr class="table-secondary fw-bold"><td class="ps-3">TOTAL</td><td class="money pe-3 text-end">${fmt(totPendapatan)}</td></tr>`;
        document.getElementById('tabelPendapatan').innerHTML = htmlPendapatan;
        document.getElementById('totalPendapatan').innerText = fmt(totPendapatan);

        // Render Belanja
        let htmlBelanja = "";
        let totBelanja = 0;
        dataBelanja.forEach((bid, index) => {
            let totalBidang = 0;
            let subHtml = "";
            
            bid.subBidang.forEach(sub => {
                subHtml += `<div class="sub-bidang-title">${sub.namaSub}</div>`;
                sub.kegiatan.forEach(keg => {
                    totalBidang += keg.nilai;
                    totBelanja += keg.nilai;
                    let wb = keg.sumber === 'DDS' ? 'bg-primary' : keg.sumber === 'ADD' ? 'bg-success' : 'bg-secondary';
                    subHtml += `<div class="rincian-item ps-3"><span class="item-detail">${keg.nama}</span><div><span class="badge ${wb} badge-sumber">${keg.sumber}</span><b class="money">${fmt(keg.nilai)}</b></div></div>`;
                });
            });

            htmlBelanja += `
            <div class="accordion-item">
                <h2 class="accordion-header" id="h${index}">
                    <button class="accordion-button ${index !== 0 ? 'collapsed' : ''}" type="button" data-bs-toggle="collapse" data-bs-target="#c${index}">
                        ${bid.bidang}
                        <span class="ms-auto badge bg-secondary">${fmt(totalBidang)}</span>
                    </button>
                </h2>
                <div id="c${index}" class="accordion-collapse collapse ${index === 0 ? 'show' : ''}" data-bs-parent="#accordionBelanja">
                    <div class="accordion-body bg-light pt-0">${subHtml}</div>
                </div>
            </div>`;
        });
        document.getElementById('accordionBelanja').innerHTML = htmlBelanja;
        document.getElementById('totalBelanja').innerText = fmt(totBelanja);
        document.getElementById('totalSelisih').innerText = fmt(totPendapatan - totBelanja);

    </script>
</body>
</html>
